sudo: required

language: java

jdk:
  - oraclejdk8

services:
  - mysql
  - docker

before_install:
  - docker build --tag myBookstore
  - docker run myBookstore
  - echo "USE mysql;\nUPDATE user SET password=PASSWORD('fangjj1998') WHERE user='root';\nFLUSH PRIVILEGES;\n" | mysql -u root
  - mysql -u root --password="fangjj1998" < sqlscript/all2.sql
  - sudo service mysql restart

install: 
  - mvn install -DskipTests=true -Dmaven.javadoc.skip=true

script: 
  - bundle exec rake test
  - mvn test

after_script:
  - docker images